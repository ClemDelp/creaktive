{"filter":false,"title":"ElementController.js","tooltip":"/api/controllers/ElementController.js","undoManager":{"mark":7,"position":7,"stack":[[{"group":"doc","deltas":[{"start":{"row":19,"column":2},"end":{"row":93,"column":4},"action":"insert","lines":["","  find : function (req,res){","    console.log(\"Fetch concepts\");","    if(req.body.params.project){","    Concept.find({","      project : req.body.params.project","    }).done(function(err,concepts){","      if(err) return res.send({err:err});","      this.concepts = concepts;","      c0 = _.findWhere(concepts, {position : 0});","     ","        res.send(concepts)","    });","  }else{","        Concept.find({","    }).done(function(err,concepts){","      if(err) return res.send({err:err});","      this.concepts = concepts;","      c0 = _.findWhere(concepts, {position : 0});","     ","        res.send(concepts)","    });","  }","","  },","","  update : function(req, res){","    console.log(\"Updating concept\",req.body.notification)","    Concept.findOne(req.body.params.id).done(function(err, concept){","      if(err) return res.send({err:err});","      if(concept){","        Concept.update({","          id: req.body.params.id","        }, req.body.params).done(function(err,c){","          if(err) res.send(err);","          req.socket.broadcast.to(c.id).emit(\"concept:update\", c[0]);","          if(req.body.notification) Notification.objectUpdated(req,res,\"Concept\", c[0], concept);","","          res.send(c[0]);","","      });","","      }else{","        var concept = req.body.params;","        ///////////////////////////","        concept.type = \"concept\";","        if((concept.top)&&(concept.top == 0))concept.top = 550;","        if((concept.left)&&(concept.left == 0))concept.left = 550;","        ///////////////////////////","        Concept.create(concept).done(function(err,c){","          if(err) return res.send({err:err});","          req.socket.broadcast.to(c.id).emit(\"concept:create\", c);","          Notification.objectCreated(req,res,\"Concept\", c);","          res.send(c);","        });","","      }","    })","  },","","  destroy : function(req,res){","    console.log('Deleting concept')","    Concept.findOne(req.body.params.id).done(function(err,concept){","      if(err) return res.send({err:err});","      if(concept.position == 0) res.send({err : \"You can't remove c0\"})","      else{","        req.socket.broadcast.to(concept.id).emit(\"concept:remove2\", concept);","        Notification.objectRemoved(req,res,\"Concept\", concept);","        concept.destroy(function(err){","          if(err) return res.send({err:err});","          res.send({msg:\"destroyed\"})","        });","      };","    });","  },"]}]}],[{"group":"doc","deltas":[{"start":{"row":18,"column":2},"end":{"row":18,"column":4},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":18,"column":0},"end":{"row":18,"column":2},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":18},"end":{"row":18,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":23},"end":{"row":20,"column":30},"action":"remove","lines":["concept"]},{"start":{"row":20,"column":23},"end":{"row":20,"column":30},"action":"insert","lines":["Element"]},{"start":{"row":22,"column":4},"end":{"row":22,"column":11},"action":"remove","lines":["Concept"]},{"start":{"row":22,"column":4},"end":{"row":22,"column":11},"action":"insert","lines":["Element"]},{"start":{"row":24,"column":25},"end":{"row":24,"column":32},"action":"remove","lines":["concept"]},{"start":{"row":24,"column":25},"end":{"row":24,"column":32},"action":"insert","lines":["Element"]},{"start":{"row":26,"column":11},"end":{"row":26,"column":18},"action":"remove","lines":["concept"]},{"start":{"row":26,"column":11},"end":{"row":26,"column":18},"action":"insert","lines":["Element"]},{"start":{"row":26,"column":22},"end":{"row":26,"column":29},"action":"remove","lines":["concept"]},{"start":{"row":26,"column":22},"end":{"row":26,"column":29},"action":"insert","lines":["Element"]},{"start":{"row":27,"column":23},"end":{"row":27,"column":30},"action":"remove","lines":["concept"]},{"start":{"row":27,"column":23},"end":{"row":27,"column":30},"action":"insert","lines":["Element"]},{"start":{"row":29,"column":17},"end":{"row":29,"column":24},"action":"remove","lines":["concept"]},{"start":{"row":29,"column":17},"end":{"row":29,"column":24},"action":"insert","lines":["Element"]},{"start":{"row":32,"column":8},"end":{"row":32,"column":15},"action":"remove","lines":["Concept"]},{"start":{"row":32,"column":8},"end":{"row":32,"column":15},"action":"insert","lines":["Element"]},{"start":{"row":33,"column":25},"end":{"row":33,"column":32},"action":"remove","lines":["concept"]},{"start":{"row":33,"column":25},"end":{"row":33,"column":32},"action":"insert","lines":["Element"]},{"start":{"row":35,"column":11},"end":{"row":35,"column":18},"action":"remove","lines":["concept"]},{"start":{"row":35,"column":11},"end":{"row":35,"column":18},"action":"insert","lines":["Element"]},{"start":{"row":35,"column":22},"end":{"row":35,"column":29},"action":"remove","lines":["concept"]},{"start":{"row":35,"column":22},"end":{"row":35,"column":29},"action":"insert","lines":["Element"]},{"start":{"row":36,"column":23},"end":{"row":36,"column":30},"action":"remove","lines":["concept"]},{"start":{"row":36,"column":23},"end":{"row":36,"column":30},"action":"insert","lines":["Element"]},{"start":{"row":38,"column":17},"end":{"row":38,"column":24},"action":"remove","lines":["concept"]},{"start":{"row":38,"column":17},"end":{"row":38,"column":24},"action":"insert","lines":["Element"]},{"start":{"row":45,"column":26},"end":{"row":45,"column":33},"action":"remove","lines":["concept"]},{"start":{"row":45,"column":26},"end":{"row":45,"column":33},"action":"insert","lines":["Element"]},{"start":{"row":46,"column":4},"end":{"row":46,"column":11},"action":"remove","lines":["Concept"]},{"start":{"row":46,"column":4},"end":{"row":46,"column":11},"action":"insert","lines":["Element"]},{"start":{"row":46,"column":59},"end":{"row":46,"column":66},"action":"remove","lines":["concept"]},{"start":{"row":46,"column":59},"end":{"row":46,"column":66},"action":"insert","lines":["Element"]},{"start":{"row":48,"column":9},"end":{"row":48,"column":16},"action":"remove","lines":["concept"]},{"start":{"row":48,"column":9},"end":{"row":48,"column":16},"action":"insert","lines":["Element"]},{"start":{"row":49,"column":8},"end":{"row":49,"column":15},"action":"remove","lines":["Concept"]},{"start":{"row":49,"column":8},"end":{"row":49,"column":15},"action":"insert","lines":["Element"]},{"start":{"row":53,"column":46},"end":{"row":53,"column":53},"action":"remove","lines":["concept"]},{"start":{"row":53,"column":46},"end":{"row":53,"column":53},"action":"insert","lines":["Element"]},{"start":{"row":54,"column":72},"end":{"row":54,"column":79},"action":"remove","lines":["Concept"]},{"start":{"row":54,"column":72},"end":{"row":54,"column":79},"action":"insert","lines":["Element"]},{"start":{"row":54,"column":88},"end":{"row":54,"column":95},"action":"remove","lines":["concept"]},{"start":{"row":54,"column":88},"end":{"row":54,"column":95},"action":"insert","lines":["Element"]},{"start":{"row":61,"column":12},"end":{"row":61,"column":19},"action":"remove","lines":["concept"]},{"start":{"row":61,"column":12},"end":{"row":61,"column":19},"action":"insert","lines":["Element"]},{"start":{"row":63,"column":8},"end":{"row":63,"column":15},"action":"remove","lines":["concept"]},{"start":{"row":63,"column":8},"end":{"row":63,"column":15},"action":"insert","lines":["Element"]},{"start":{"row":63,"column":24},"end":{"row":63,"column":31},"action":"remove","lines":["concept"]},{"start":{"row":63,"column":24},"end":{"row":63,"column":31},"action":"insert","lines":["Element"]},{"start":{"row":64,"column":12},"end":{"row":64,"column":19},"action":"remove","lines":["concept"]},{"start":{"row":64,"column":12},"end":{"row":64,"column":19},"action":"insert","lines":["Element"]},{"start":{"row":64,"column":27},"end":{"row":64,"column":34},"action":"remove","lines":["concept"]},{"start":{"row":64,"column":27},"end":{"row":64,"column":34},"action":"insert","lines":["Element"]},{"start":{"row":64,"column":45},"end":{"row":64,"column":52},"action":"remove","lines":["concept"]},{"start":{"row":64,"column":45},"end":{"row":64,"column":52},"action":"insert","lines":["Element"]},{"start":{"row":65,"column":12},"end":{"row":65,"column":19},"action":"remove","lines":["concept"]},{"start":{"row":65,"column":12},"end":{"row":65,"column":19},"action":"insert","lines":["Element"]},{"start":{"row":65,"column":28},"end":{"row":65,"column":35},"action":"remove","lines":["concept"]},{"start":{"row":65,"column":28},"end":{"row":65,"column":35},"action":"insert","lines":["Element"]},{"start":{"row":65,"column":47},"end":{"row":65,"column":54},"action":"remove","lines":["concept"]},{"start":{"row":65,"column":47},"end":{"row":65,"column":54},"action":"insert","lines":["Element"]},{"start":{"row":67,"column":8},"end":{"row":67,"column":15},"action":"remove","lines":["Concept"]},{"start":{"row":67,"column":8},"end":{"row":67,"column":15},"action":"insert","lines":["Element"]},{"start":{"row":67,"column":23},"end":{"row":67,"column":30},"action":"remove","lines":["concept"]},{"start":{"row":67,"column":23},"end":{"row":67,"column":30},"action":"insert","lines":["Element"]},{"start":{"row":69,"column":46},"end":{"row":69,"column":53},"action":"remove","lines":["concept"]},{"start":{"row":69,"column":46},"end":{"row":69,"column":53},"action":"insert","lines":["Element"]},{"start":{"row":70,"column":46},"end":{"row":70,"column":53},"action":"remove","lines":["Concept"]},{"start":{"row":70,"column":46},"end":{"row":70,"column":53},"action":"insert","lines":["Element"]},{"start":{"row":79,"column":26},"end":{"row":79,"column":33},"action":"remove","lines":["concept"]},{"start":{"row":79,"column":26},"end":{"row":79,"column":33},"action":"insert","lines":["Element"]},{"start":{"row":80,"column":4},"end":{"row":80,"column":11},"action":"remove","lines":["Concept"]},{"start":{"row":80,"column":4},"end":{"row":80,"column":11},"action":"insert","lines":["Element"]},{"start":{"row":80,"column":58},"end":{"row":80,"column":65},"action":"remove","lines":["concept"]},{"start":{"row":80,"column":58},"end":{"row":80,"column":65},"action":"insert","lines":["Element"]},{"start":{"row":82,"column":9},"end":{"row":82,"column":16},"action":"remove","lines":["concept"]},{"start":{"row":82,"column":9},"end":{"row":82,"column":16},"action":"insert","lines":["Element"]},{"start":{"row":84,"column":32},"end":{"row":84,"column":39},"action":"remove","lines":["concept"]},{"start":{"row":84,"column":32},"end":{"row":84,"column":39},"action":"insert","lines":["Element"]},{"start":{"row":84,"column":50},"end":{"row":84,"column":57},"action":"remove","lines":["concept"]},{"start":{"row":84,"column":50},"end":{"row":84,"column":57},"action":"insert","lines":["Element"]},{"start":{"row":84,"column":68},"end":{"row":84,"column":75},"action":"remove","lines":["concept"]},{"start":{"row":84,"column":68},"end":{"row":84,"column":75},"action":"insert","lines":["Element"]},{"start":{"row":85,"column":44},"end":{"row":85,"column":51},"action":"remove","lines":["Concept"]},{"start":{"row":85,"column":44},"end":{"row":85,"column":51},"action":"insert","lines":["Element"]},{"start":{"row":85,"column":54},"end":{"row":85,"column":61},"action":"remove","lines":["concept"]},{"start":{"row":85,"column":54},"end":{"row":85,"column":61},"action":"insert","lines":["Element"]},{"start":{"row":86,"column":8},"end":{"row":86,"column":15},"action":"remove","lines":["concept"]},{"start":{"row":86,"column":8},"end":{"row":86,"column":15},"action":"insert","lines":["Element"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":0},"end":{"row":64,"column":0},"action":"remove","lines":["        Element.type = \"Element\";",""]}]}],[{"group":"doc","deltas":[{"start":{"row":62,"column":0},"end":{"row":64,"column":66},"action":"remove","lines":["        ///////////////////////////","        if((Element.top)&&(Element.top == 0))Element.top = 550;","        if((Element.left)&&(Element.left == 0))Element.left = 550;"]}]}],[{"group":"doc","deltas":[{"start":{"row":61,"column":38},"end":{"row":62,"column":0},"action":"remove","lines":["",""]}]}]]},"ace":{"folds":[],"scrolltop":840,"scrollleft":0,"selection":{"start":{"row":88,"column":4},"end":{"row":88,"column":4},"isBackwards":false},"options":{"tabSize":2,"useSoftTabs":true,"guessTabSize":false,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":59,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1419251181465,"hash":"73cc4ac212f81bd6044230e4693d7de91ddb86ae"}