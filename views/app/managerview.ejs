<!-- Javascript libs -->


<div class="off-canvas-wrap">
  <div class="inner-wrap">
    <nav class="top-bar" data-topbar>
      <ul class="title-area">
        <li class="name">
          <h1><a href="/">CreaKtive</a></h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
      </ul>

      <section class="top-bar-section">        
        <!-- Left Nav Section -->

        <ul class="right">
                <li class="divider"></li>
          <li><h5><a class="active" href="/logout">Logout</a></h5></li>
<li class="divider"></li>
          <li class="has-form">
            <a href="http://creaktive.fr/contact/" class="button">FeedBack</a>
          </li>
        </ul>
      </section>
    </nav>

    <nav class="tab-bar">
      <section class="middle tab-bar-section">
        <h1>Manager (<span id="notificationsCounter">0</span>)</h1>
      </section>

      <section class="left-small">
        <a class="left-off-canvas-toggle menu-icon" ><span></span></a>
      </section>
      

<section class="right-small">
        <a class="right-off-canvas-toggle menu-icon" ><span></span></a>
      </section>
    </nav>

    <aside class="left-off-canvas-menu" >
      <ul class="off-canvas-list" id="notificationsList">
        ...
      </ul>
    </aside>

    <aside class="right-off-canvas-menu">
      <ul class="off-canvas-list" id="connectedUsers">
      </ul>
    </aside>


    <section class="main-section">
<!-- Templates to load -->

<%- partial('./templates/manager_template') %>










<!-- Javascript libs -->
<script src="/js/vendor/backbone.iosync.js"></script>
<script src="/js/vendor/backbone.iobind.js"></script>
<script type="text/javascript" src="js/vendor/socket.io.js"></script>
<script type="text/javascript" src="js/sails.io.js"></script>

<script src="js/BB_app/global_functions.js"></script>
<!-- Interface client/server -->
<script type="text/javascript" src="js/BB_app/app_manager.js"></script>
<!-- Global objects -->
<script src="js/BB_app/global_models.js"></script>
<script src="js/BB_app/global_collections.js"></script>

<!-- Modules situÃ©s dans BB_app -->
<script src="js/BB_app/modules/manager.js"></script>
<script src="js/BB_app/modules/topbar.js"></script>

<script>

	$(document).ready(function () {

		Backbone.Model.prototype.toJSON = function() {
			return JSON.parse(JSON.stringify(this.attributes));
		};

		rt(io, function(){
  // Initialisation de l'managerlication ici
  console.log( "CreaKtive DOM loaded!" );
  global.init('<%- currentUser %>');

  topBar.init();
  manager.init();      
  ////////////////////////////////////////
  /*activat of "hashchange events's monitoring"*/
  Backbone.history.start();
})
	}) ;



	function rt (io, callback) {
  // as soon as this file is loaded, connect automatically, 
  var socket = io.connect("/",{'sync disconnect on unload ': true});
  socket.on('connect', function socketConnected() {
    socket.get("/auth/openChannels", function(data){
      // console.log(data.msg);
      // console.log(data.channels);
    });
    console.log(
      'Socket is now connected and globally accessible as `socket`.\n' + 
      'e.g. to send a GET request to Sails, try \n' + 
      '`socket.get("/", function (response) ' +
        '{ console.log(response); })`'
    );
    callback();
  });

  window.socket = socket;

};

</script>