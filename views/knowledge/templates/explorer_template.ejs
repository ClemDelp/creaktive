<div id="explorer_container"></div>
<!-- //////////////////////////////////////////////////////////////////////: -->
<!-- Modal part -->
<div id="explorer_tags_modal_container" class="reveal-modal small" data-reveal></div>
<div id="explorer_comments_modal_container" class="reveal-modal small" data-reveal></div>
<div id="explorer_attachment_modal_container" class="reveal-modal small" data-reveal></div>
<!-- //////////////////////////////////////////////////////////////////////: -->
<!-- Timeline template parts -->
<script type="text/template" id="explorer-knowledge-normal-template">
    <div class="row">
        <div class="large-2 medium-2 small-2 columns">
            <a href="#" data-dropdown="label{{-knowledge.id}}" class="button tiny round dropdown" style="background-color:{{- knowledge.color }}">
            {{ if(knowledge.color == "#27AE60"){ }}Validated{{ }else if(knowledge.color == "#F39C12"){ }}Processing{{ }else{ }}Missing{{ } }}
            </a><br>
            <ul id="label{{-knowledge.id}}" data-dropdown-content class="f-dropdown">
              <li><a href="#" class="updateLabel" data-knowledge-id="{{-knowledge.id}}" data-label-color="#27AE60">validated</a></li>
              <li><a href="#" class="updateLabel" data-knowledge-id="{{-knowledge.id}}" data-label-color="#F39C12">processing</a></li>
              <li><a href="#" class="updateLabel" data-knowledge-id="{{-knowledge.id}}" data-label-color="#C0392B">missing</a></li>
            </ul>
            <i>Last update by <b>{{-knowledge.user.name}}</b> at {{-knowledge.date}}</i>
        </div>
        <div class="large-8 medium-8 small-8 columns">
            <h4>{{- knowledge.title}}</h4>
            {{= knowledge.content }}
        </div>
        <div class="large-2 medium-2 small-2 columns">
            <a href="#" class="button tiny round edit expand">Edit</a>
            <a href="#" class="button tiny round alert remove expand">Remove</a>
            <a href="#" class="button tiny round secondary openCommentsModal expand" data-knowledge-id="{{-knowledge.id}}">comments ({{- knowledge.comments.length }})</a>
        </div>
    </div>
    <div class="row">
        <hr>
        <span class="secondary round label">tags ({{- knowledge.tags.length }})</span> -
        {{ _.each(knowledge.tags, function(tag) { }}
            <span class="success round label" style="cursor:pointer">{{-tag}}</span>
        {{ }); }}
        <span class="alert round label openTagsModal" style="cursor:pointer" data-knowledge-id="{{-knowledge.id}}">+</span>
        <hr>
    </div>
    <div class="row">
        <span class="secondary round label">attachments ({{- knowledge.attachment.length }})</span> -
        {{ _.each(knowledge.attachment, function(file) { }}
            <a href="#" data-dropdown="drop{{-file.id}}" class="button tiny round success dropdown">{{- file.name }}</a>
            <ul id="drop{{-file.id}}" data-dropdown-content class="f-dropdown">
              <li><a href="#" class="openFile" data-file-path="{{- file.path}}">Open</a></li>
              <li><a href="#" class="removeFile" data-file-id="{{- file.id}}">Remove</a></li>
            </ul>
        {{ }); }}
        <span class="alert round label openAttachmentModal" style="cursor:pointer" data-knowledge-id="{{-knowledge.id}}">+</span>
    </div>
</script>

<script type="text/template" id="explorer-knowledge-edition-template">
    <div class="row">
        <input type="text" class="title" value="{{- knowledge.title}}"/>
        <textarea  class="ckeditor"  name="editor" rows="10" cols="80">{{= knowledge.content }}</textarea>
        <hr>
        <a href="#" class="button tiny round success updateKnowledge">Update!</a>
        <a href="#" class="button tiny round secondary cancelEdition">Cancel</a>
    </div>
</script>

<!-- //////////////////////////////////////////////////////////////////////: -->
<!-- Left part -->
<script type="text/template" id="explorer-accordion-header-template">
    <a href="#{{- idAcc }}">{{- title }}</a>
</script>

<script type="text/template" id="explorer-search-template">
    <input type="text" class="search" placeholder="search in {{-title}}...">
</script>


<script type="text/template" id="explorer-project-template">
    <div class="row">
        <div class="small-12 medium-12 large-8 columns">
            <button class="tiny button radius alert addFilter expand" data-filter-type="project" data-filter-model="{{-project.id}}">
                    {{- project.title }} - <font style="color:white">({{- rec }})</font>
            </button>
        </div>
        <div class="progress alert show-for-large-up large-4 large-4 columns">
          <span class="meter" style="width: {{-per}}%"></span>
        </div>
    </div>
</script>


<script type="text/template" id="explorer-expert-template">
    <div class="row">
        <div class="small-12 medium-12 large-8 columns">
            <button class="tiny radius button alert addFilter expand" data-filter-type="expert" data-filter-model="{{-expert.id}}">
                    {{- expert.name }} - <font style="color:white">({{- rec }})</font>
            </button>
        </div>
        <div class="progress alert show-for-large-up large-4 large-4 columns">
          <span class="meter" style="width: {{-per}}%"></span>
        </div>
    </div>
</script>

<script type="text/template" id="explorer-concept-template">
    <div class="row">
                <div class="small-12 medium-12 large-8 columns">
                        <button class="tiny radius button addFilter expand" style="background:{{-concept.color}}" data-filter-type="concept" data-filter-model="{{-concept.id}}">
                                {{- concept.title }} - <font style="color:red">({{- rec }})</font>
                        </button>
                </div>
                <div class="progress show-for-large-up large-4 columns">
                  <span class="meter" style="background:{{-concept.color}};width: {{-per}}%"></span>
                </div>
        </div>
</script>


<script type="text/template" id="explorer-poche-template">
    <div class="row">
        <div class="small-12 medium-12 large-8 columns">
            <button class="tiny success radius button addFilter expand" data-filter-type="poche" data-filter-model="{{-poche.id}}">
                {{- poche.title }} - <font style="color:red">({{- rec }})</font>
            </button>
        </div>
        <div class="progress success show-for-large-up large-4 large-4 columns">
          <span class="meter" style="width: {{-per}}%"></span>
        </div>
    </div>
</script>

<!-- //////////////////////////////////////////////////////////////////////: -->
<!-- Middle part -->
<script type="text/template" id="explorer-knowledges-template">

        {{ _.each(knowledges, function(knowledge) { }}
            <button class="button radius round openModal" style="background:{{-knowledge.color}}" data-id-knowledge="{{- knowledge.id }}">{{-knowledge.title}}</button>
        {{ }); }}
        
</script>

<script type="text/template" id="explorer-states-template">
    <dd>
        <a href="#states_dd">States</a>
        <div id="states_dd" class="content">
            <button class="expand button radius tiny addFilter" data-filter-type="notLinked">not linked</button>
            <button class="expand button radius tiny success addFilter" data-filter-type="notCategorised">not categorised</button>
            <button class="expand button radius tiny addFilter" style="background-color : #27AE60 " data-filter-type="state" data-filter-model="#27AE60">V</button>
            <button class="expand button radius tiny addFilter" style="background-color : #F39C12 " data-filter-type="state" data-filter-model="#F39C12">P</a>
            <button class="expand button radius tiny addFilter" style="background-color : #C0392B " data-filter-type="state" data-filter-model="#C0392B">M</button>
        </div>
    </dd>
</script>

<script type="text/template" id="explorer-context-template">
        <div class="">
                Context :  
                {{ _.each(filters, function(filter) { }}
                    {{ if(filter.type == "concept"){ }}
                            <a class="tiny round button remove" data-id-filter="{{-filter.id}}">{{- filter.model.title }}</a> +
                    {{ }else if(filter.type == "project"){ }}
                            <a class="tiny round alert button remove" data-id-filter="{{-filter.id}}">{{- filter.model.title }}</a> +
                    {{ }else if(filter.type == "poche"){ }}
                            <a class="tiny round success button remove" data-id-filter="{{-filter.id}}">{{- filter.model.title }}</a> +
                    {{ }else if(filter.type == "expert"){ }}        
                            <a class="tiny round alert button remove" data-id-filter="{{-filter.id}}">{{- filter.model.name }}</a> +
                    {{ }else if(filter.type == "state"){ }}
                        {{ var name="Validated"; if(filter.model == "#F39C12"){name="Processing"}else if(filter.model == "#C0392B"){name="Missing";} }}
                        <a class="tiny round button remove" style="background-color : {{- filter.model}} " data-id-filter="{{-filter.id}}">{{- name }}</a> +
                    {{ }else if(filter.type == "notLinked"){ }}
                        <a class="tiny round button remove" data-id-filter="{{-filter.id}}">not linked</a> +
                    {{ }else if(filter.type == "notCategorised"){ }}
                        <a class="tiny round button success remove" data-id-filter="{{-filter.id}}">not categorised</a> +
                    {{ } }}
                {{ }); }}
        </div>
        <div class="">
                <div class="row collapse">
                    <div class="small-10 columns">
                      <input id="explorer_new_k_title" class="search" type="text" placeholder="Add a knowledge in the current context..."/>
                    </div>
                    <div class="small-2 columns">
                      <a href="#" class="button postfix addKnowledge">Add</a>
                    </div>
                </div>
        </div>

</script>